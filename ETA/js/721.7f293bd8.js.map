{"version":3,"file":"js/721.7f293bd8.js","mappings":"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","sources":["webpack://vue-test2/./src/views/Citybus_Route.vue?bcdc","webpack://vue-test2/src/views/Citybus_Route.vue","webpack://vue-test2/./src/views/Citybus_Route.vue?2b03","webpack://vue-test2/./src/views/Citybus_Route.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('h4',[_vm._v(_vm._s(_vm.route)+\" \"+_vm._s(_vm.origin)+\" 往 \"+_vm._s(_vm.destination))]),_c('div',{staticClass:\"stop-list\"},[_c('table',{staticClass:\"table text-left\"},[_vm._m(0),_c('tbody',_vm._l((_vm.route_stop_list),function(stop){return _c('tr',{key:stop.id,ref:'stop'+stop.seq,refInFor:true,on:{\"click\":function($event){_vm.stop_seq_clicked = stop.seq; _vm.stop_click(stop.seq, stop.stop)}}},[_c('td',{staticClass:\"td-seq\"},[(!(stop.star))?_c('img',{attrs:{\"src\":require(\"@/assets/star.png\"),\"width\":\"25px\"},on:{\"click\":function($event){return _vm.star_click(stop.seq)}}}):_vm._e(),(stop.star)?_c('img',{attrs:{\"src\":require(\"@/assets/starred.png\"),\"width\":\"25px\"},on:{\"click\":function($event){return _vm.star_click(stop.seq)}}}):_vm._e(),_c('span',[_vm._v(\" \"+_vm._s(stop.seq))]),_c('br')]),_c('td',[_c('div',{class:[stop.seq == _vm.stop_seq_clicked ? \"font-weight-bold\": '']},[_vm._v(_vm._s(stop.name_tc))]),(_vm.stop_seq_clicked == stop.seq)?_c('div',[(!(stop.eta_1 || stop.eta_2 || stop.eta_3) && _vm.eta_loaded)?_c('div',[_vm._v(\" 暫時沒有預定班次 \")]):_vm._e(),(stop.eta_1)?_c('div',[_c('span',{staticClass:\"eta-time-diff\"},[_vm._v(_vm._s(stop.eta_1.time_diff))]),_c('span',{staticClass:\"eta-time-diff-desc\"},[_vm._v(\" 分鐘\")]),_c('span',{staticClass:\"eta-time\"},[_vm._v(\" (\"+_vm._s(stop.eta_1.time)+\")\")]),(stop.eta_1.rmk_tc)?_c('span',{staticClass:\"eta-rmk\"},[_vm._v(\" (\"+_vm._s(stop.eta_1.rmk_tc)+\")\")]):_vm._e()]):_vm._e(),(stop.eta_2)?_c('div',[_c('span',{staticClass:\"eta-time-diff\"},[_vm._v(_vm._s(stop.eta_2.time_diff))]),_c('span',{staticClass:\"eta-time-diff-desc\"},[_vm._v(\" 分鐘\")]),_c('span',{staticClass:\"eta-time\"},[_vm._v(\" (\"+_vm._s(stop.eta_2.time)+\")\")]),(stop.eta_2.rmk_tc)?_c('span',{staticClass:\"eta-rmk\"},[_vm._v(\" (\"+_vm._s(stop.eta_2.rmk_tc)+\")\")]):_vm._e()]):_vm._e(),(stop.eta_3)?_c('div',[_c('span',{staticClass:\"eta-time-diff\"},[_vm._v(_vm._s(stop.eta_3.time_diff))]),_c('span',{staticClass:\"eta-time-diff-desc\"},[_vm._v(\" 分鐘\")]),_c('span',{staticClass:\"eta-time\"},[_vm._v(\" (\"+_vm._s(stop.eta_3.time)+\")\")]),(stop.eta_3.rmk_tc)?_c('span',{staticClass:\"eta-rmk\"},[_vm._v(\" (\"+_vm._s(stop.eta_3.rmk_tc)+\")\")]):_vm._e()]):_vm._e()]):_vm._e()])])}),0)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('thead',{staticClass:\"thead-dark\"},[_c('tr',[_c('th',[_vm._v(\"站數\")]),_c('th',[_vm._v(\"巴士站\")])])])}]\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"container\">\r\n        <h4>{{route}} {{origin}} 往 {{destination}}</h4>\r\n\r\n        <div class=\"stop-list\">\r\n            <table class=\"table text-left\">\r\n                <thead class=\"thead-dark\">\r\n                    <tr>\r\n                        <th>站數</th>\r\n                        <th>巴士站</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <!--tr v-for=\"stop in current_route_stop_list\" :key=\"stop.id\" @click=\"stop_click(stop.seq)\"-->\r\n                    <tr v-for=\"stop in route_stop_list\" :key=\"stop.id\" @click=\"stop_seq_clicked = stop.seq; stop_click(stop.seq, stop.stop)\" :ref=\"'stop'+stop.seq\">\r\n                        <td class=\"td-seq\">\r\n                            <img src=\"@/assets/star.png\" v-if=\"!(stop.star)\" width=\"25px\" @click=\"star_click(stop.seq)\">\r\n                            <img src=\"@/assets/starred.png\" v-if=\"stop.star\" width=\"25px\" @click=\"star_click(stop.seq)\">\r\n                            <span> {{ stop.seq }}</span><br>\r\n                        </td>\r\n                        <td>\r\n                            <div :class=\"[stop.seq == stop_seq_clicked ? `font-weight-bold`: '']\">{{ stop.name_tc }}</div>\r\n                            \r\n                            <div v-if=\"stop_seq_clicked == stop.seq\">\r\n                                <div v-if=\"!(stop.eta_1 || stop.eta_2 || stop.eta_3) && eta_loaded\">\r\n                                    暫時沒有預定班次\r\n                                </div>\r\n                                <div v-if=\"stop.eta_1\">\r\n                                    <span class=\"eta-time-diff\">{{ stop.eta_1.time_diff }}</span><span class=\"eta-time-diff-desc\"> 分鐘</span>\r\n                                    <span class=\"eta-time\"> ({{ stop.eta_1.time }})</span>\r\n                                    <span class=\"eta-rmk\" v-if=\"stop.eta_1.rmk_tc\"> ({{ stop.eta_1.rmk_tc }})</span>\r\n                                </div>\r\n                                <div v-if=\"stop.eta_2\">\r\n                                    <span class=\"eta-time-diff\">{{ stop.eta_2.time_diff }}</span><span class=\"eta-time-diff-desc\"> 分鐘</span>\r\n                                    <span class=\"eta-time\"> ({{ stop.eta_2.time }})</span>\r\n                                    <span class=\"eta-rmk\" v-if=\"stop.eta_2.rmk_tc\"> ({{ stop.eta_2.rmk_tc }})</span>\r\n                                </div>\r\n                                <div v-if=\"stop.eta_3\">\r\n                                    <span class=\"eta-time-diff\">{{ stop.eta_3.time_diff }}</span><span class=\"eta-time-diff-desc\"> 分鐘</span>\r\n                                    <span class=\"eta-time\"> ({{ stop.eta_3.time }})</span>\r\n                                    <span class=\"eta-rmk\" v-if=\"stop.eta_3.rmk_tc\"> ({{ stop.eta_3.rmk_tc }})</span>\r\n                                </div>\r\n                            </div>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport * as util from '../util/util'\r\n\r\nexport default {\r\n    name: 'Citybus_ETA',\r\n    data(){\r\n        return {\r\n            company: this.$route.params.company,\r\n            route: this.$route.params.route,\r\n            direction: this.$route.params.direction,\r\n            origin: \"\",\r\n            destination: \"\",\r\n            stop_list: [],\r\n            route_list: [],\r\n            route_stop_list: [],\r\n            current_route_stop_list: [],\r\n            stop_seq_clicked: 0,\r\n            eta_loaded: false,\r\n        }\r\n    },\r\n    computed: {\r\n        star_image_src: function(){\r\n            return this.current_route_stop_list.map(function(route_stop){\r\n                if (route_stop.star){\r\n                    return \"@/assets/star.png\";\r\n                }\r\n                else {\r\n                    return \"@/assets/star.png\";\r\n                }\r\n            });\r\n        }\r\n    },\r\n    mounted() {\r\n        let that = this;\r\n        \r\n        // Load route stop table\r\n        (async () => {\r\n            // Load route destination\r\n            await util.getNWFBCTBRouteList(that.company, that.route);\r\n            if (that.company == 'NWFB'){\r\n                that.route_list = JSON.parse(localStorage.getItem(\"NWFBRouteList\"));\r\n            }\r\n            else if (that.company == 'CTB'){\r\n                that.route_list = JSON.parse(localStorage.getItem(\"CTBRouteList\"));\r\n            }\r\n\r\n            let route_list_find = that.route_list.find(route_item => route_item.route == that.route);\r\n\r\n            if (route_list_find){\r\n                if (that.direction == \"outbound\"){\r\n                    that.origin = route_list_find.orig_tc;\r\n                    that.destination = route_list_find.dest_tc;\r\n                }\r\n                else {\r\n                    that.origin = route_list_find.dest_tc;\r\n                    that.destination = route_list_find.orig_tc;\r\n                }\r\n            }\r\n\r\n            // Load stop list table\r\n            let temp_route_stop_list = await util.getNWFBCTBRouteStop(that.company, that.route, that.direction);\r\n            temp_route_stop_list = temp_route_stop_list.data;\r\n\r\n            let promises = [];\r\n            that.stop_list = [];\r\n            for (let i = 0; i < temp_route_stop_list.length; i++){\r\n                let stop_id = temp_route_stop_list[i].stop;\r\n                promises.push(util.getNWFBCTBStop(stop_id));\r\n            }\r\n            await Promise.all(promises).then((values) => {\r\n                values.forEach((stop) => {\r\n                    that.stop_list.push(stop.data);\r\n                });\r\n            });\r\n\r\n            temp_route_stop_list.map((route) => {\r\n                let stop = that.stop_list.find(stop => stop.stop == route.stop);\r\n                if (stop && stop.name_tc){\r\n                    route.name_tc = stop.name_tc;\r\n                }\r\n                return route;\r\n            });\r\n            that.route_stop_list = temp_route_stop_list;\r\n\r\n            // if stop seq specified in query string, trigger click of the stop\r\n            let param_seq = that.$route.query.seq;\r\n            console.log(\"param_seq\" + param_seq);\r\n            \r\n            if (param_seq){\r\n                let stop_id = this.get_stop_id_clicked(param_seq);\r\n                console.log(stop_id);\r\n                that.stop_seq_clicked = param_seq;\r\n                that.stop_click(param_seq, stop_id);\r\n                \r\n                // TODO: check :ref=\"'stop'+stop.seq\"\r\n                // scroll to the row\r\n            }\r\n            \r\n            // load star list\r\n            let star_list = JSON.parse(localStorage.getItem(\"NWFBCTBRouteStopStar\"));\r\n            if (star_list){\r\n                that.route_stop_list = that.route_stop_list.map((route) => {\r\n                    let route_dir = route.direction == \"outbound\" ? 'O' : 'I';\r\n                    let found = star_list.find(star => (star.route == route.route &&\r\n                                                        star.dir == route_dir &&\r\n                                                        star.seq == route.seq));\r\n                    if (found){\r\n                        route.star = true;\r\n                    }\r\n                    else {\r\n                        route.star = false;\r\n                    }\r\n\r\n                    return route;\r\n                });\r\n            }\r\n            \r\n\r\n        })();\r\n\r\n        setInterval(() => { \r\n            if (that.eta_loaded){\r\n                let stop_id = this.get_stop_id_clicked(that.stop_seq_clicked);\r\n                that.stop_click(that.stop_seq_clicked, stop_id) ;\r\n            }\r\n        }, 10000);\r\n\r\n    },\r\n    methods: {\r\n        stop_click: function(stop_seq, stop_id){\r\n            // load ETA\r\n            let dir;\r\n            if (this.direction == \"outbound\") dir = 'O';\r\n            else if (this.direction == \"inbound\") dir = 'I';\r\n\r\n            (async () => {\r\n                let eta_data = await util.getNWFBCTBETA(this.company, stop_id, this.route);\r\n                eta_data = eta_data.data;\r\n                let eta_1 = eta_data.find(eta => eta.route == this.route &&\r\n                                                 eta.dir == dir &&\r\n                                                 eta.seq == stop_seq &&\r\n                                                 eta.eta_seq == 1);\r\n                let eta_2 = eta_data.find(eta => eta.route == this.route &&\r\n                                                 eta.dir == dir &&\r\n                                                 eta.seq == stop_seq &&\r\n                                                 eta.eta_seq == 2);\r\n                let eta_3 = eta_data.find(eta => eta.route == this.route &&\r\n                                                 eta.dir == dir &&\r\n                                                 eta.seq == stop_seq &&\r\n                                                 eta.eta_seq == 3);\r\n\r\n                // map eta to route stop list\r\n                this.route_stop_list = this.route_stop_list.map((e) => {\r\n                    if (eta_1){\r\n                        if (eta_1.eta){\r\n                            e.eta_1 = eta_1;\r\n                            e.eta_1.time = util.formatTime(eta_1.eta);\r\n                            e.eta_1.time_diff = util.etaTimeDifference(eta_1.eta);\r\n                        }\r\n                    }\r\n                    if (eta_2){\r\n                        if (eta_2.eta){\r\n                            e.eta_2 = eta_2;\r\n                            e.eta_2.time = util.formatTime(eta_2.eta);\r\n                            e.eta_2.time_diff = util.etaTimeDifference(eta_2.eta);\r\n                        }\r\n                    }\r\n                    if (eta_3){\r\n                        if (eta_3.eta){\r\n                            e.eta_3 = eta_3;\r\n                            e.eta_3.time = util.formatTime(eta_3.eta);\r\n                            e.eta_3.time_diff = util.etaTimeDifference(eta_3.eta);\r\n                        }\r\n                    }\r\n\r\n                    return e;\r\n                });\r\n\r\n                this.eta_loaded = true;\r\n            })();\r\n        },\r\n        get_stop_id_clicked: function(seq){\r\n            let stop_clicked = this.route_stop_list.find(stop => stop.seq == seq);\r\n            if (stop_clicked && stop_clicked.stop){\r\n                return stop_clicked.stop;\r\n            }\r\n            return 0;\r\n        },\r\n        star_click: function(stop_seq){\r\n            let that = this;\r\n            let dir;\r\n\r\n            if (that.direction == \"outbound\") dir = 'O';\r\n            else if (that.direction == \"inbound\") dir = 'I';\r\n\r\n            // find the stop object\r\n            let stop_item = {\r\n                route: that.route,\r\n                dir: dir,\r\n                seq: stop_seq\r\n            };\r\n\r\n            // if found in star list, remove the starred item from the list, and change the image src\r\n            // else add the item to star list, and change the image src\r\n\r\n            let star_list = localStorage.getItem(\"NWFBCTBRouteStopStar\");\r\n            star_list = JSON.parse(star_list);\r\n\r\n            if (!star_list){\r\n                star_list = [];\r\n            }\r\n            let star_item_index = -1;\r\n\r\n            // find the index of object with starred item\r\n            for (let i = 0; i < star_list.length; i++){\r\n                if ((star_list[i]).route == stop_item.route &&\r\n                    (star_list[i]).dir == stop_item.dir &&\r\n                    (star_list[i]).seq == stop_item.seq){\r\n                    star_item_index = i;\r\n                    break;\r\n                }\r\n            }\r\n\r\n            // starred --> unstar\r\n            if (star_item_index > -1){\r\n                star_list.splice(star_item_index, 1);\r\n\r\n                // update current_route_stop_list star to false\r\n                for (let i = 0; i < this.route_stop_list.length; i++){\r\n                    let item = this.route_stop_list[i];\r\n                    if (item.route == stop_item.route &&\r\n                        item.dir == stop_item.dir && \r\n                        item.seq == stop_item.seq){\r\n\r\n                        (this.route_stop_list[i]).star = false;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            else {  // unstar --> starred\r\n                star_list.push(stop_item);\r\n\r\n                // update current_route_stop_list star to true\r\n                // update current_route_stop_list star to false\r\n                for (let i = 0; i < this.route_stop_list.length; i++){\r\n                    let item = this.route_stop_list[i];\r\n                    if (item.route == stop_item.route &&\r\n                        item.dir == stop_item.dir && \r\n                        item.seq == stop_item.seq){\r\n                        \r\n                        (this.route_stop_list[i]).star = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            localStorage.setItem(\"NWFBCTBRouteStopStar\", JSON.stringify(star_list));\r\n\r\n        },\r\n    },\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.td-seq {\r\n    width: 100px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Citybus_Route.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Citybus_Route.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Citybus_Route.vue?vue&type=template&id=1af3d96a&scoped=true&\"\nimport script from \"./Citybus_Route.vue?vue&type=script&lang=js&\"\nexport * from \"./Citybus_Route.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Citybus_Route.vue?vue&type=style&index=0&id=1af3d96a&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1af3d96a\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","route","origin","destination","_m","_l","stop","key","id","ref","seq","refInFor","on","$event","stop_seq_clicked","stop_click","_e","attrs","star_click","class","name_tc","eta_1","eta_2","eta_3","eta_loaded","time_diff","time","rmk_tc","staticRenderFns","name","data","company","direction","stop_list","route_list","route_stop_list","current_route_stop_list","computed","star_image_src","mounted","that","temp_route_stop_list","promises","values","console","star","setInterval","methods","eta_data","eta","e","get_stop_id_clicked","dir","star_list","star_item_index","item","localStorage","component"],"sourceRoot":""}