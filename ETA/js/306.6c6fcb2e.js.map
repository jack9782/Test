{"version":3,"file":"js/306.6c6fcb2e.js","mappings":"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","sources":["webpack://vue-test2/./src/views/KMB_Route.vue?25b3","webpack://vue-test2/src/views/KMB_Route.vue","webpack://vue-test2/./src/views/KMB_Route.vue?c3b6","webpack://vue-test2/./src/views/KMB_Route.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('h4',[_vm._v(_vm._s(_vm.route)+\" \"+_vm._s(_vm.origin)+\" 往 \"+_vm._s(_vm.destination))]),_c('div',{staticClass:\"stop-list\"},[_c('table',{staticClass:\"table\"},[_vm._m(0),_c('tbody',_vm._l((_vm.current_route_stop_list),function(stop){return _c('tr',{key:stop.id,on:{\"click\":function($event){return _vm.stop_click(stop.seq)}}},[_c('td',[(!stop.starred)?_c('img',{attrs:{\"src\":require(\"../assets/star.png\"),\"width\":\"25px\"}}):_vm._e(),(stop.starred)?_c('img',{attrs:{\"src\":require(\"../assets/starred.png\"),\"width\":\"25px\"}}):_vm._e(),_vm._v(\" \"+_vm._s(stop.seq)+\" \")]),_c('td',{staticClass:\"text-left\"},[_c('div',{class:[stop.seq == _vm.stop_seq_clicked ? \"font-weight-bold\": '']},[_vm._v(_vm._s(stop.name_tc))]),(_vm.stop_seq_clicked == stop.seq)?_c('div',[(!(stop.eta_1 || stop.eta_2 || stop.eta_3))?_c('div',[_vm._v(\" 暫時沒有預定班次 \")]):_vm._e(),(stop.eta_1)?_c('div',[_c('span',{staticClass:\"eta-time-diff\"},[_vm._v(_vm._s(stop.eta_1.time_diff))]),_c('span',{staticClass:\"eta-time-diff-desc\"},[_vm._v(\" 分鐘\")]),_c('span',{staticClass:\"eta-time\"},[_vm._v(\" (\"+_vm._s(stop.eta_1.time)+\")\")]),(stop.eta_1.rmk_tc)?_c('span',{staticClass:\"eta-rmk\"},[_vm._v(\" (\"+_vm._s(stop.eta_1.rmk_tc)+\")\")]):_vm._e()]):_vm._e(),(stop.eta_2)?_c('div',[_c('span',{staticClass:\"eta-time-diff\"},[_vm._v(_vm._s(stop.eta_2.time_diff))]),_c('span',{staticClass:\"eta-time-diff-desc\"},[_vm._v(\" 分鐘\")]),_c('span',{staticClass:\"eta-time\"},[_vm._v(\" (\"+_vm._s(stop.eta_2.time)+\")\")]),(stop.eta_2.rmk_tc)?_c('span',{staticClass:\"eta-rmk\"},[_vm._v(\" (\"+_vm._s(stop.eta_2.rmk_tc)+\")\")]):_vm._e()]):_vm._e(),(stop.eta_3)?_c('div',[_c('span',{staticClass:\"eta-time-diff\"},[_vm._v(_vm._s(stop.eta_3.time_diff))]),_c('span',{staticClass:\"eta-time-diff-desc\"},[_vm._v(\" 分鐘\")]),_c('span',{staticClass:\"eta-time\"},[_vm._v(\" (\"+_vm._s(stop.eta_3.time)+\")\")]),(stop.eta_3.rmk_tc)?_c('span',{staticClass:\"eta-rmk\"},[_vm._v(\" (\"+_vm._s(stop.eta_3.rmk_tc)+\")\")]):_vm._e()]):_vm._e()]):_vm._e()])])}),0)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('thead',[_c('tr',[_c('th',[_vm._v(\"站數\")]),_c('th',[_vm._v(\"巴士站\")])])])}]\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"container\">\r\n        <h4>{{route}} {{origin}} 往 {{destination}}</h4>\r\n\r\n        <div class=\"stop-list\">\r\n            <table class=\"table\">\r\n                <thead>\r\n                    <tr>\r\n                        <th>站數</th>\r\n                        <th>巴士站</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"stop in current_route_stop_list\" :key=\"stop.id\" @click=\"stop_click(stop.seq)\">\r\n                        <td>\r\n                            <!--input type=\"image\" class=\"star mr-2\" width=\"25px\" src=\"../assets/star.png\" style=\"vertical-align: middle\"-->\r\n                            <img src=\"../assets/star.png\" v-if=\"!stop.starred\" width=\"25px\">\r\n                            <img src=\"../assets/starred.png\" v-if=\"stop.starred\" width=\"25px\">\r\n                            {{ stop.seq }}\r\n                        </td>\r\n                        <td class=\"text-left\">\r\n                            <div :class=\"[stop.seq == stop_seq_clicked ? `font-weight-bold`: '']\">{{ stop.name_tc }}</div>\r\n                            <div v-if=\"stop_seq_clicked == stop.seq\">\r\n                                <div v-if=\"!(stop.eta_1 || stop.eta_2 || stop.eta_3)\">\r\n                                    暫時沒有預定班次\r\n                                </div>\r\n                                <div v-if=\"stop.eta_1\">\r\n                                    <span class=\"eta-time-diff\">{{ stop.eta_1.time_diff }}</span><span class=\"eta-time-diff-desc\"> 分鐘</span>\r\n                                    <span class=\"eta-time\"> ({{ stop.eta_1.time }})</span>\r\n                                    <span class=\"eta-rmk\" v-if=\"stop.eta_1.rmk_tc\"> ({{ stop.eta_1.rmk_tc }})</span>\r\n                                </div>\r\n                                <div v-if=\"stop.eta_2\">\r\n                                    <span class=\"eta-time-diff\">{{ stop.eta_2.time_diff }}</span><span class=\"eta-time-diff-desc\"> 分鐘</span>\r\n                                    <span class=\"eta-time\"> ({{ stop.eta_2.time }})</span>\r\n                                    <span class=\"eta-rmk\" v-if=\"stop.eta_2.rmk_tc\"> ({{ stop.eta_2.rmk_tc }})</span>\r\n                                </div>\r\n                                <div v-if=\"stop.eta_3\">\r\n                                    <span class=\"eta-time-diff\">{{ stop.eta_3.time_diff }}</span><span class=\"eta-time-diff-desc\"> 分鐘</span>\r\n                                    <span class=\"eta-time\"> ({{ stop.eta_3.time }})</span>\r\n                                    <span class=\"eta-rmk\" v-if=\"stop.eta_3.rmk_tc\"> ({{ stop.eta_3.rmk_tc }})</span>\r\n                                </div>\r\n                            </div>\r\n                        </td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport * as util from '../util/util'\r\n\r\nexport default {\r\n    name: 'KMB_ETA',\r\n    data(){\r\n        return {\r\n            route: this.$route.params.route,\r\n            bound: this.$route.params.bound,\r\n            service_type: this.$route.params.service_type,\r\n            origin: \"\",\r\n            destination: \"\",\r\n            stop_list: [],\r\n            route_list: [],\r\n            route_stop_list: [],\r\n            current_route_stop_list: [],\r\n            stop_seq_clicked: 0,\r\n            eta_loaded: false,\r\n        }\r\n    },\r\n    computed: {\r\n        is_row_clicked: function(stop_seq){\r\n            if (stop_seq == this.stop_seq_clicked)  {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        },\r\n    },\r\n    mounted() {\r\n        let that = this;\r\n        \r\n        // Load route destination\r\n        (async () => {\r\n            await util.getKMBRouteList()\r\n            this.route_list = JSON.parse(localStorage.getItem(\"KMBRouteList\"))\r\n            let route_list_find = this.route_list.find(route_item => route_item.route == this.route && route_item.bound == this.bound && route_item.service_type == this.service_type);\r\n            if (route_list_find){\r\n                this.origin = route_list_find.orig_tc;\r\n                this.destination = route_list_find.dest_tc;\r\n            }\r\n            else {\r\n                // route not found\r\n                location.href = \"/KMB\"\r\n            }\r\n        })();\r\n\r\n        // Load stop list table        \r\n        (async () => {\r\n            await util.getKMBRouteStopList()\r\n            that.loadStop();\r\n        })();\r\n\r\n        setInterval(() => { \r\n            if (this.eta_loaded){\r\n                this.stop_click(this.stop_seq_clicked) ;\r\n            }\r\n        }, 10000);\r\n\r\n    },\r\n    methods: {\r\n        loadStop: function(){\r\n            let all_route_stop_list = JSON.parse(localStorage.getItem(\"KMBRouteStopList\"));\r\n            let stop_list = JSON.parse(localStorage.getItem(\"KMBStopList\"));\r\n            \r\n            let route_stop_list = all_route_stop_list.filter(route_stop => route_stop.route == this.route && route_stop.bound == this.bound && route_stop.service_type == this.service_type);\r\n            \r\n            // map route_stop_list and stop_list\r\n            this.current_route_stop_list = route_stop_list.map((e) => {\r\n                let temp = stop_list.find(stop => stop.stop == e.stop)\r\n                \r\n                if (temp.stop){\r\n                    e.name_tc = temp.name_tc;\r\n                }\r\n                return e;\r\n            });\r\n            \r\n            // map current_route_stop_list and starred list\r\n            // TODO\r\n            let star_list = localStorage.getItem(\"KMBRouteStopStar\");\r\n            if (star_list){\r\n                this.current_route_stop_list = this.current_route_stop_list.map((e) => {\r\n                    let temp = star_list.find(star => star.route == e.route &&\r\n                                                      star.bound == e.bound &&\r\n                                                      star.service_type == e.service_type &&\r\n                                                      star.stop == e.stop &&\r\n                                                      star_list.seq == e.seq);\r\n                    console.log(temp);\r\n                });               \r\n            }\r\n\r\n        },\r\n        stop_click: function(stop_seq){\r\n            // load ETA\r\n            this.stop_seq_clicked = stop_seq;\r\n\r\n            (async () => {\r\n                let eta_data = await util.getKMBRouteETA(this.route, this.service_type);\r\n                eta_data = eta_data.data;\r\n                let eta_1 = eta_data.find(eta => eta.route == this.route &&\r\n                                                 eta.dir == this.bound &&\r\n                                                 eta.service_type == this.service_type &&\r\n                                                 eta.seq == stop_seq &&\r\n                                                 eta.eta_seq == 1);\r\n                let eta_2 = eta_data.find(eta => eta.route == this.route &&\r\n                                                 eta.dir == this.bound &&\r\n                                                 eta.service_type == this.service_type &&\r\n                                                 eta.seq == stop_seq &&\r\n                                                 eta.eta_seq == 2);\r\n                let eta_3 = eta_data.find(eta => eta.route == this.route &&\r\n                                                 eta.dir == this.bound &&\r\n                                                 eta.service_type == this.service_type &&\r\n                                                 eta.seq == stop_seq &&\r\n                                                 eta.eta_seq == 3);\r\n\r\n                // map eta to route stop list\r\n                this.current_route_stop_list = this.current_route_stop_list.map((e) => {\r\n                    if (eta_1.eta){\r\n                        e.eta_1 = eta_1;\r\n                        e.eta_1.time = util.formatTime(eta_1.eta);\r\n                        e.eta_1.time_diff = util.etaTimeDifference(eta_1.eta);\r\n                    }\r\n                    if (eta_2.eta){\r\n                        e.eta_2 = eta_2;\r\n                        e.eta_2.time = util.formatTime(eta_2.eta);\r\n                        e.eta_2.time_diff = util.etaTimeDifference(eta_2.eta);\r\n                    }\r\n                    if (eta_3){\r\n                        e.eta_3 = eta_3;\r\n                        e.eta_3.time = util.formatTime(eta_3.eta);\r\n                        e.eta_3.time_diff = util.etaTimeDifference(eta_3.eta);\r\n                    }\r\n                    \r\n                    return e;\r\n                });\r\n\r\n                this.eta_loaded = true;\r\n\r\n            })();\r\n            \r\n        },\r\n\r\n    },\r\n\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KMB_Route.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./KMB_Route.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./KMB_Route.vue?vue&type=template&id=d2e55aba&scoped=true&\"\nimport script from \"./KMB_Route.vue?vue&type=script&lang=js&\"\nexport * from \"./KMB_Route.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d2e55aba\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","route","origin","destination","_m","_l","stop","key","id","on","$event","stop_click","seq","starred","_e","attrs","class","stop_seq_clicked","name_tc","eta_1","eta_2","eta_3","time_diff","time","rmk_tc","staticRenderFns","name","data","bound","service_type","stop_list","route_list","route_stop_list","current_route_stop_list","eta_loaded","computed","is_row_clicked","mounted","location","that","setInterval","methods","loadStop","e","star","star_list","console","eta_data","eta","component"],"sourceRoot":""}