{"version":3,"file":"js/614-legacy.ca9cef62.js","mappings":"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","sources":["webpack://vue-test2/./src/views/Home.vue?7edb","webpack://vue-test2/src/views/Home.vue","webpack://vue-test2/./src/views/Home.vue?a806","webpack://vue-test2/./src/views/Home.vue","webpack://vue-test2/./node_modules/core-js/modules/es.array.find.js"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('button',{staticClass:\"btn btn-primary\",on:{\"click\":_vm.download_data}},[_vm._v(\"下載數據\")]),_c('div',{staticClass:\"star-route\"},[(_vm.star_route_stop_eta_list.length == 0)?_c('p',[_vm._v(\"沒有已儲存路線\")]):_vm._e(),(_vm.star_route_stop_eta_list.length > 0)?_c('table',{staticClass:\"table\"},[_vm._m(0),_c('tbody',_vm._l((_vm.star_route_stop_eta_list),function(route){return _c('router-link',{key:route.id,attrs:{\"tag\":\"tr\",\"to\":_vm.route_link('KMB', route.route, route.bound, route.service_type, route.seq)}},[_c('td',{staticClass:\"td-route\"},[_vm._v(_vm._s(route.route)+\" \"),_c('br'),_c('span',{staticClass:\"co-desc\"},[_vm._v(\"九巴/龍運\")])]),_c('td',[_c('div',[_vm._v(\" 往 \"+_vm._s(route.dest_tc)+\" \")]),_c('div',[_vm._v(\" \"+_vm._s(route.name_tc)+\" \")])]),_c('td',{class:[_vm.display_type == 'full'? '': \"text-left\"]},[_c('div',[(!(route.eta_1 || route.eta_2 || route.eta_3) && _vm.eta_loaded)?_c('div',[_vm._v(\" X \")]):_vm._e(),(route.eta_1)?_c('div',[_c('span',{staticClass:\"eta-time-diff\"},[_vm._v(_vm._s(route.eta_1.time_diff))]),_c('span',{staticClass:\"eta-time-diff-desc\"},[_vm._v(\" 分鐘\")]),(_vm.display_type != 'sm')?_c('span',{staticClass:\"eta-time\"},[_vm._v(\" (\"+_vm._s(route.eta_1.time)+\")\")]):_vm._e(),(route.eta_1.rmk_tc && _vm.display_type == 'full')?_c('span',{staticClass:\"eta-rmk\"},[_vm._v(\" (\"+_vm._s(route.eta_1.rmk_tc)+\")\")]):_vm._e()]):_vm._e(),(route.eta_2)?_c('div',[_c('span',{staticClass:\"eta-time-diff\"},[_vm._v(_vm._s(route.eta_2.time_diff))]),_c('span',{staticClass:\"eta-time-diff-desc\"},[_vm._v(\" 分鐘\")]),(_vm.display_type != 'sm')?_c('span',{staticClass:\"eta-time\"},[_vm._v(\" (\"+_vm._s(route.eta_2.time)+\")\")]):_vm._e(),(route.eta_2.rmk_tc && _vm.display_type == 'full')?_c('span',{staticClass:\"eta-rmk\"},[_vm._v(\" (\"+_vm._s(route.eta_2.rmk_tc)+\")\")]):_vm._e()]):_vm._e(),(route.eta_3)?_c('div',[_c('span',{staticClass:\"eta-time-diff\"},[_vm._v(_vm._s(route.eta_3.time_diff))]),_c('span',{staticClass:\"eta-time-diff-desc\"},[_vm._v(\" 分鐘\")]),(_vm.display_type != 'sm')?_c('span',{staticClass:\"eta-time\"},[_vm._v(\" (\"+_vm._s(route.eta_3.time)+\")\")]):_vm._e(),(route.eta_3.rmk_tc && _vm.display_type == 'full')?_c('span',{staticClass:\"eta-rmk\"},[_vm._v(\" (\"+_vm._s(route.eta_3.rmk_tc)+\")\")]):_vm._e()]):_vm._e()])])])}),1)]):_vm._e()])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('thead',[_c('th',[_vm._v(\"路線\")]),_c('th',[_vm._v(\"方向\")]),_c('th',[_vm._v(\"時間\")])])}]\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"container\">\r\n        <!--h1>This is home page.</h1-->\r\n        <button class=\"btn btn-primary\" @click=\"download_data\">下載數據</button>\r\n        <!--star route table-->\r\n        <div class=\"star-route\">\r\n            <p v-if=\"star_route_stop_eta_list.length == 0\">沒有已儲存路線</p>\r\n            <table class=\"table\" v-if=\"star_route_stop_eta_list.length > 0\">\r\n                <thead>\r\n                    <th>路線</th>\r\n                    <th>方向</th>\r\n                    <th>時間</th>\r\n                </thead>\r\n                <tbody>\r\n                    <!--KMB-->\r\n                    <router-link tag=\"tr\" v-for=\"route in star_route_stop_eta_list\" :key=\"route.id\" :to=\"route_link('KMB', route.route, route.bound, route.service_type, route.seq)\">\r\n                        <td class=\"td-route\">{{ route.route }} <br><span class=\"co-desc\">九巴/龍運</span></td>\r\n                        <td>\r\n                            <div>\r\n                                往 {{ route.dest_tc }}\r\n                            </div>\r\n                            <div>\r\n                                {{ route.name_tc }}\r\n                            </div>\r\n                        </td>\r\n                        <td :class=\"[display_type == 'full'? '': `text-left`]\">\r\n                            <div>\r\n                                <div v-if=\"!(route.eta_1 || route.eta_2 || route.eta_3) && eta_loaded\">\r\n                                    X\r\n                                </div>\r\n                                <div v-if=\"route.eta_1\">\r\n                                    <span class=\"eta-time-diff\">{{ route.eta_1.time_diff }}</span><span class=\"eta-time-diff-desc\"> 分鐘</span>\r\n                                    <span class=\"eta-time\" v-if=\"display_type != 'sm'\"> ({{ route.eta_1.time }})</span>\r\n                                    <span class=\"eta-rmk\" v-if=\"route.eta_1.rmk_tc && display_type == 'full'\"> ({{ route.eta_1.rmk_tc }})</span>\r\n                                </div>\r\n                                <div v-if=\"route.eta_2\">\r\n                                    <span class=\"eta-time-diff\">{{ route.eta_2.time_diff }}</span><span class=\"eta-time-diff-desc\"> 分鐘</span>\r\n                                    <span class=\"eta-time\" v-if=\"display_type != 'sm'\"> ({{ route.eta_2.time }})</span>\r\n                                    <span class=\"eta-rmk\" v-if=\"route.eta_2.rmk_tc && display_type == 'full'\"> ({{ route.eta_2.rmk_tc }})</span>\r\n                                </div>\r\n                                <div v-if=\"route.eta_3\">\r\n                                    <span class=\"eta-time-diff\">{{ route.eta_3.time_diff }}</span><span class=\"eta-time-diff-desc\"> 分鐘</span>\r\n                                    <span class=\"eta-time\" v-if=\"display_type != 'sm'\"> ({{ route.eta_3.time }})</span>\r\n                                    <span class=\"eta-rmk\" v-if=\"route.eta_3.rmk_tc && display_type == 'full'\"> ({{ route.eta_3.rmk_tc }})</span>\r\n                                </div>\r\n                            </div>\r\n                        </td>\r\n                    </router-link>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport * as util from '../util/util'\r\n\r\n//let KMBRouteList;\r\n\r\nexport default {\r\n    name: 'HomePage',\r\n    data(){\r\n        return {\r\n            full_route_list: [],\r\n            full_route_stop_list: [],\r\n            full_stop_list: [],\r\n            star_list: [],\r\n            star_route_stop_eta_list: [],\r\n            show_detail: true,\r\n            eta_loaded: false,\r\n            window_width: window.innerWidth,\r\n        }\r\n    },\r\n    computed: {\r\n        display_type: function(){\r\n            if (this.window_width < 370){\r\n                return \"sm\";\r\n            }\r\n            else if (this.window_width < 500){\r\n                return \"md\";\r\n            }\r\n            else {\r\n                return \"full\";\r\n            }\r\n        }\r\n    },\r\n    created() {\r\n        window.addEventListener(\"resize\", this.onResize);\r\n    },\r\n    mounted() {\r\n        \r\n        let that = this;\r\n        (async () => {\r\n            let promises = [];\r\n            promises.push(util.getKMBRouteList());\r\n            promises.push(util.getKMBStopList());\r\n            promises.push(util.getKMBRouteStopList());\r\n            await Promise.all(promises);\r\n            that.full_route_list = JSON.parse(localStorage.getItem(\"KMBRouteList\"));\r\n            that.full_stop_list = JSON.parse(localStorage.getItem(\"KMBStopList\"));\r\n            that.full_route_stop_list = JSON.parse(localStorage.getItem(\"KMBRouteStopList\"));\r\n            that.star_list = JSON.parse(localStorage.getItem(\"KMBRouteStopStar\"));\r\n            \r\n            if (that.star_list){\r\n\r\n                // map star_list with route information\r\n                that.star_route_stop_eta_list = that.star_list.map((e) => {\r\n\r\n                    let route_match = that.full_route_list.find(route => (\r\n                        route.route == e.route &&\r\n                        route.bound == e.bound &&\r\n                        route.service_type == e.service_type\r\n                    ));\r\n\r\n                    if (route_match){\r\n                        e.orig_tc = route_match.orig_tc;\r\n                        e.dest_tc = route_match.dest_tc;\r\n                    }\r\n\r\n                    return e;\r\n                });\r\n                \r\n                // map star_list with route stop information\r\n                that.star_route_stop_eta_list = that.star_route_stop_eta_list.map((e) => {\r\n\r\n                    let route_stop_match = that.full_route_stop_list.find(route_stop => (\r\n                        route_stop.route == e.route &&\r\n                        route_stop.bound == e.bound &&\r\n                        route_stop.service_type == e.service_type &&\r\n                        route_stop.seq == e.seq\r\n                    ));\r\n\r\n                    if (route_stop_match){\r\n                        e.stop = route_stop_match.stop;\r\n                    }\r\n                    \r\n                    return e;\r\n                });\r\n\r\n                // map star_list with stop information\r\n                that.star_route_stop_eta_list = that.star_route_stop_eta_list.map((e) => {\r\n\r\n                    let stop_match = that.full_stop_list.find(stop => (\r\n                        stop.stop == e.stop\r\n                    ));\r\n\r\n                    if (stop_match){\r\n                        e.name_tc = stop_match.name_tc;\r\n                    }\r\n\r\n                    return e;\r\n                });\r\n\r\n                // get eta for each stop\r\n                \r\n                console.log(\"load eta\");\r\n                this.load_eta();\r\n                setTimeout(() => {\r\n                    //this.load_eta();\r\n                }, 500);\r\n                \r\n                setInterval(() => {\r\n                    console.log(\"reload eta\");\r\n                    this.load_eta();\r\n\r\n                }, 10000);\r\n            }\r\n\r\n        })();\r\n        \r\n    },\r\n    methods: {\r\n        route_link: function(company, route, bound, service_type, seq) {\r\n            return '/' + company + '/' + route + '/' + bound + '/' + service_type + '?seq=' + seq;\r\n        },\r\n        load_eta: function(){\r\n            // util.KMB_ETA_LINK: stop_id, route, service_type\r\n\r\n            (async () => {\r\n                for (let i = 0; i < this.star_route_stop_eta_list.length; i++){\r\n                    let item = this.star_route_stop_eta_list[i];\r\n                    let stop = item.stop;\r\n                    let route = item.route;\r\n                    let service_type = item.service_type;\r\n                    let bound = item.bound;\r\n                    let seq = item.seq;\r\n\r\n                    let eta_data = await util.getKMBETA(stop, route, service_type);\r\n                    eta_data = eta_data.data;\r\n\r\n                    let eta_1 = eta_data.find(eta => eta.route == route &&\r\n                                                     eta.dir == bound &&\r\n                                                     eta.service_type == service_type &&\r\n                                                     eta.seq == seq &&\r\n                                                     eta.eta_seq == 1);\r\n                    let eta_2 = eta_data.find(eta => eta.route == route &&\r\n                                                     eta.dir == bound &&\r\n                                                     eta.service_type == service_type &&\r\n                                                     eta.seq == seq &&\r\n                                                     eta.eta_seq == 2);\r\n                    let eta_3 = eta_data.find(eta => eta.route == route &&\r\n                                                     eta.dir == bound &&\r\n                                                     eta.service_type == service_type &&\r\n                                                     eta.seq == seq &&\r\n                                                     eta.eta_seq == 3);\r\n                    \r\n                    this.eta_loaded = true;\r\n\r\n                    // map eta to route stop list\r\n                    this.star_route_stop_eta_list = this.star_route_stop_eta_list.map((e) => {\r\n                        if (eta_1 && eta_1.eta && \r\n                            eta_1.route == e.route &&\r\n                            eta_1.dir == e.bound &&\r\n                            eta_1.service_type == e.service_type &&\r\n                            eta_1.seq == e.seq){\r\n                            e.eta_1 = eta_1;\r\n                            e.eta_1.time = util.formatTime(eta_1.eta);\r\n                            e.eta_1.time_diff = util.etaTimeDifference(eta_1.eta);\r\n                        }\r\n                        if (eta_2 && eta_2.eta && \r\n                            eta_2.route == e.route &&\r\n                            eta_2.dir == e.bound &&\r\n                            eta_2.service_type == e.service_type &&\r\n                            eta_2.seq == e.seq){\r\n                            e.eta_2 = eta_2;\r\n                            e.eta_2.time = util.formatTime(eta_2.eta);\r\n                            e.eta_2.time_diff = util.etaTimeDifference(eta_2.eta);\r\n                        }\r\n                        if (eta_3 && eta_3.eta && \r\n                            eta_3.route == e.route &&\r\n                            eta_3.dir == e.bound &&\r\n                            eta_3.service_type == e.service_type &&\r\n                            eta_3.seq == e.seq){\r\n                            e.eta_3 = eta_3;\r\n                            e.eta_3.time = util.formatTime(eta_3.eta);\r\n                            e.eta_3.time_diff = util.etaTimeDifference(eta_3.eta);\r\n                        }\r\n\r\n                        return e;\r\n                    });\r\n                }\r\n            })();\r\n        },\r\n        onResize(){\r\n            this.window_width = window.innerWidth;\r\n        },\r\n        download_data: function(){\r\n            try {\r\n                // clear all localStorage\r\n                localStorage.clear();\r\n\r\n                // call API to download data\r\n                (async () => {\r\n                    let promises = [];\r\n                    console.log(\"Get KMB / NWFB / CTB Route List\");\r\n                    console.log(\"Start time: \" + new Date());\r\n                    // promises for multiple requests\r\n                    promises.push(util.getKMBRouteList());\r\n                    promises.push(util.getKMBStopList());\r\n                    promises.push(util.getKMBRouteStopList());\r\n                    promises.push(util.getNWFBCTBRouteList('NWFB'));\r\n                    promises.push(util.getNWFBCTBRouteList('CTB'));\r\n\r\n                    await Promise.all(promises).then((values) => {\r\n                        console.log(\"End time: \" + new Date());\r\n                        console.log(JSON.stringify(values));\r\n                    });\r\n                    \r\n                    console.log(\"Downloading NWFB / CTB Route & Stop List ...\");\r\n                    await util.getNWFBCTBRouteStopList();\r\n\r\n                    console.log(\"Data download complete!\");\r\n                })();\r\n                \r\n            } catch (err){\r\n                console.log(\"[Download data error]: \" + err);\r\n                alert(\"網絡錯誤，請重新下載數據！\");\r\n            }\r\n            \r\n\r\n        }\r\n    }\r\n}\r\n\r\n/* Local storage:\r\n    KMBRouteList_timestamp: store the last updated timestamp of the KMBRouteList in localStorage\r\n    KMBRouteList: store the KMBRouteList retrieved from API\r\n */\r\n</script>\r\n\r\n<style scoped>\r\n.td-route{\r\n    width: 80px;\r\n}\r\n.co-desc{\r\n    font-size: 8px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Home.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Home.vue?vue&type=template&id=2fed615b&scoped=true&\"\nimport script from \"./Home.vue?vue&type=script&lang=js&\"\nexport * from \"./Home.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Home.vue?vue&type=style&index=0&id=2fed615b&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2fed615b\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.es/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","on","download_data","_v","star_route_stop_eta_list","length","_e","_m","_l","route","key","id","attrs","route_link","bound","service_type","seq","_s","dest_tc","name_tc","class","display_type","eta_1","eta_2","eta_3","eta_loaded","time_diff","time","rmk_tc","staticRenderFns","name","data","full_route_list","full_route_stop_list","full_stop_list","star_list","show_detail","window_width","computed","created","window","mounted","promises","Promise","that","e","route_stop","stop","console","setTimeout","setInterval","methods","load_eta","i","item","util","eta_data","eta","onResize","localStorage","alert","component","$","$find","addToUnscopables","FIND","SKIPS_HOLES","Array","target","proto","forced","find","callbackfn","arguments","undefined"],"sourceRoot":""}