"use strict";(self["webpackChunkvue_test2"]=self["webpackChunkvue_test2"]||[]).push([[306],{7306:function(t,e,s){s.r(e),s.d(e,{default:function(){return d}});var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("h4",[t._v(t._s(t.route)+" "+t._s(t.origin)+" 往 "+t._s(t.destination))]),i("div",{staticClass:"stop-list"},[i("table",{staticClass:"table"},[t._m(0),i("tbody",t._l(t.current_route_stop_list,(function(e){return i("tr",{key:e.id,on:{click:function(s){return t.stop_click(e.seq)}}},[i("td",[e.starred?t._e():i("img",{attrs:{src:s(6101),width:"25px"}}),e.starred?i("img",{attrs:{src:s(8767),width:"25px"}}):t._e(),t._v(" "+t._s(e.seq)+" ")]),i("td",{staticClass:"text-left"},[i("div",{class:[e.seq==t.stop_seq_clicked?"font-weight-bold":""]},[t._v(t._s(e.name_tc))]),t.stop_seq_clicked==e.seq?i("div",[e.eta_1||e.eta_2||e.eta_3?t._e():i("div",[t._v(" 暫時沒有預定班次 ")]),e.eta_1?i("div",[i("span",{staticClass:"eta-time-diff"},[t._v(t._s(e.eta_1.time_diff))]),i("span",{staticClass:"eta-time-diff-desc"},[t._v(" 分鐘")]),i("span",{staticClass:"eta-time"},[t._v(" ("+t._s(e.eta_1.time)+")")]),e.eta_1.rmk_tc?i("span",{staticClass:"eta-rmk"},[t._v(" ("+t._s(e.eta_1.rmk_tc)+")")]):t._e()]):t._e(),e.eta_2?i("div",[i("span",{staticClass:"eta-time-diff"},[t._v(t._s(e.eta_2.time_diff))]),i("span",{staticClass:"eta-time-diff-desc"},[t._v(" 分鐘")]),i("span",{staticClass:"eta-time"},[t._v(" ("+t._s(e.eta_2.time)+")")]),e.eta_2.rmk_tc?i("span",{staticClass:"eta-rmk"},[t._v(" ("+t._s(e.eta_2.rmk_tc)+")")]):t._e()]):t._e(),e.eta_3?i("div",[i("span",{staticClass:"eta-time-diff"},[t._v(t._s(e.eta_3.time_diff))]),i("span",{staticClass:"eta-time-diff-desc"},[t._v(" 分鐘")]),i("span",{staticClass:"eta-time"},[t._v(" ("+t._s(e.eta_3.time)+")")]),e.eta_3.rmk_tc?i("span",{staticClass:"eta-rmk"},[t._v(" ("+t._s(e.eta_3.rmk_tc)+")")]):t._e()]):t._e()]):t._e()])])})),0)])])])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th",[t._v("站數")]),s("th",[t._v("巴士站")])])])}],_=s(8638),r={name:"KMB_ETA",data(){return{route:this.$route.params.route,bound:this.$route.params.bound,service_type:this.$route.params.service_type,origin:"",destination:"",stop_list:[],route_list:[],route_stop_list:[],current_route_stop_list:[],stop_seq_clicked:0,eta_loaded:!1}},computed:{is_row_clicked:function(t){return t==this.stop_seq_clicked}},mounted(){let t=this;(async()=>{await _.Zt(),this.route_list=JSON.parse(localStorage.getItem("KMBRouteList"));let t=this.route_list.find((t=>t.route==this.route&&t.bound==this.bound&&t.service_type==this.service_type));t?(this.origin=t.orig_tc,this.destination=t.dest_tc):location.href="/KMB"})(),(async()=>{await _.vw(),t.loadStop()})(),setInterval((()=>{this.eta_loaded&&this.stop_click(this.stop_seq_clicked)}),1e4)},methods:{loadStop:function(){let t=JSON.parse(localStorage.getItem("KMBRouteStopList")),e=JSON.parse(localStorage.getItem("KMBStopList")),s=t.filter((t=>t.route==this.route&&t.bound==this.bound&&t.service_type==this.service_type));this.current_route_stop_list=s.map((t=>{let s=e.find((e=>e.stop==t.stop));return s.stop&&(t.name_tc=s.name_tc),t}));let i=localStorage.getItem("KMBRouteStopStar");i&&(this.current_route_stop_list=this.current_route_stop_list.map((t=>{let e=i.find((e=>e.route==t.route&&e.bound==t.bound&&e.service_type==t.service_type&&e.stop==t.stop&&i.seq==t.seq));console.log(e)})))},stop_click:function(t){this.stop_seq_clicked=t,(async()=>{let e=await _.I0(this.route,this.service_type);e=e.data;let s=e.find((e=>e.route==this.route&&e.dir==this.bound&&e.service_type==this.service_type&&e.seq==t&&1==e.eta_seq)),i=e.find((e=>e.route==this.route&&e.dir==this.bound&&e.service_type==this.service_type&&e.seq==t&&2==e.eta_seq)),a=e.find((e=>e.route==this.route&&e.dir==this.bound&&e.service_type==this.service_type&&e.seq==t&&3==e.eta_seq));this.current_route_stop_list=this.current_route_stop_list.map((t=>(s.eta&&(t.eta_1=s,t.eta_1.time=_.mr(s.eta),t.eta_1.time_diff=_.pm(s.eta)),i.eta&&(t.eta_2=i,t.eta_2.time=_.mr(i.eta),t.eta_2.time_diff=_.pm(i.eta)),a&&(t.eta_3=a,t.eta_3.time=_.mr(a.eta),t.eta_3.time_diff=_.pm(a.eta)),t))),this.eta_loaded=!0})()}}},o=r,c=s(1001),n=(0,c.Z)(o,i,a,!1,null,"d2e55aba",null),d=n.exports},6101:function(t,e,s){t.exports=s.p+"img/star.5f894ed9.png"},8767:function(t,e,s){t.exports=s.p+"img/starred.5d1433f5.png"}}]);
//# sourceMappingURL=306.6c6fcb2e.js.map